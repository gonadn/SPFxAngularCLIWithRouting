{"version":3,"sources":["data/RushConfiguration.ts"],"names":[],"mappings":";AAAA,4FAA4F;AAC5F,2DAA2D;;AAE3D,6BAA6B;AAC7B,gCAAgC;AAChC,iCAAiC;AACjC,oEAAoE;AAEpE,kCAA2B;AAC3B,yEAAqG;AACrG,+EAA4E;AAC5E,sDAA+C;AAC/C,oDAAiD;AACjD,qEAAkE;AAClE,6CAAsC;AACtC,6EAA0E;AAE1E,MAAM,mCAAmC,GAAW,OAAO,CAAC;AAE5D;;;GAGG;AACH,MAAM,wBAAwB,GAAa;IACzC,QAAQ;IACR,6BAAa,CAAC,qBAAqB;IACnC,6BAAa,CAAC,sBAAsB;IACpC,6BAAa,CAAC,+BAA+B;IAC7C,6BAAa,CAAC,kCAAkC;IAChD,6BAAa,CAAC,uBAAuB;IACrC,6BAAa,CAAC,mBAAmB;CAClC,CAAC;AAoEF;;;;GAIG;AACH;IAudE;;;OAGG;IACH,YAAoB,qBAA6C,EAAE,gBAAwB;QACzF,EAAE,CAAC,CAAC,qBAAqB,CAAC,yBAAyB,CAAC,CAAC,CAAC;YACpD,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,UAAU,CAAC,qBAAqB,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;gBACxE,MAAM,IAAI,KAAK,CAAC,6EAA6E;sBACzF,2BAA2B,qBAAqB,CAAC,yBAAyB,GAAG,CAAC,CAAC;YACrF,CAAC;YACD,EAAE,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,OAAO,EAAE,qBAAqB,CAAC,yBAAyB,CAAC,CAAC,CAAC,CAAC;gBACxF,MAAM,IAAI,KAAK,CAAC,mDAAmD,OAAO,CAAC,OAAO,aAAa;sBAC3F,wFAAwF;sBACxF,wCAAwC,qBAAqB,CAAC,yBAAyB,IAAI,CAAC,CAAC;YACnG,CAAC;QACH,CAAC;QACD,IAAI,CAAC,aAAa,GAAG,gBAAgB,CAAC;QACtC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAEtD,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,EAAE,6BAAa,CAAC,gBAAgB,CAAC,CAAC,CAAC;QAEnG,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;QAC/E,iBAAiB,CAAC,+BAA+B,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;QAEhF,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,6BAAa,CAAC,kBAAkB,CAAC,CAAC;QACzF,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,WAAW,CAAC,CAAC,CAAC;QACpF,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,SAAS,CAAC,CAAC,CAAC;QAEhF,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,6BAAa,CAAC,qBAAqB,CAAC,CAAC;QAEzF,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,6BAAa,CAAC,qBAAqB,CAAC,CAAC;QACjH,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,6BAAa,CAAC,qBAAqB,CAAC,CAAC;QAEtG,IAAI,CAAC,WAAW,GAAG,iBAAiB,CAAC,gBAAgB,EAAE,CAAC;QAExD,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,gBAAgB,CAAC,CAAC;QAEjF,IAAI,CAAC,eAAe,GAAG,qBAAqB,CAAC,UAAU,CAAC;QACxD,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,EACnE,WAAW,EAAE,cAAc,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC,CAAC;QAE/C,IAAI,CAAC,sBAAsB,GAAG,qBAAqB,CAAC,qBAAqB,KAAK,SAAS;cACnF,qBAAqB,CAAC,qBAAqB,GAAG,CAAC,CAAC;QACpD,EAAE,CAAC,CAAC,IAAI,CAAC,sBAAsB,GAAG,CAAC,CAAC,CAAC,CAAC;YACpC,MAAM,IAAI,KAAK,CAAC,gEAAgE,CAAC,CAAC;QACpF,CAAC;QAED,IAAI,CAAC,sBAAsB,GAAG,qBAAqB,CAAC,qBAAqB,KAAK,SAAS;cACnF,qBAAqB,CAAC,qBAAqB,GAAG,CAAC,CAAC;QACpD,EAAE,CAAC,CAAC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,CAAC,CAAC;YAC9D,MAAM,IAAI,KAAK,CAAC,4EAA4E,CAAC,CAAC;QAChG,CAAC;QAED,IAAI,CAAC,uBAAuB,GAAG,IAAI,+CAAsB,CAAC,IAAI,EAAE,qBAAqB,CAAC,CAAC;QAEvF,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;QAClC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,EAAE,CAAC,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC,CAAC;YACpC,EAAE,CAAC,CAAC,qBAAqB,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC;gBAChD,IAAI,CAAC,eAAe,GAAG,qBAAqB,CAAC,SAAS,CAAC,WAAW,CAAC;YACrE,CAAC;YAED,EAAE,CAAC,CAAC,qBAAqB,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC,CAAC;gBACxD,IAAI,CAAC,uBAAuB,GAAG,qBAAqB,CAAC,SAAS,CAAC,mBAAmB,CAAC;gBAEnF,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;oBAC3C,MAAM,IAAI,KAAK,CAAC,0DAA0D;wBACxE,oDAAoD,CAAC,CAAC;gBAC1D,CAAC;YACH,CAAC;QACH,CAAC;QAED,EAAE,CAAC,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC,CAAC;YACrC,IAAI,CAAC,cAAc,GAAG,qBAAqB,CAAC,UAAU,CAAC,GAAG,CAAC;QAC7D,CAAC;QAED,IAAI,CAAC,iBAAiB,GAAG,CAAC,CAAC,qBAAqB,CAAC,gBAAgB,CAAC;QAClE,EAAE,CAAC,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC,CAAC;YACrC,IAAI,CAAC,WAAW,GAAG,IAAI,oBAAU,CAAC,qBAAqB,CAAC,UAAU,CAAC,CAAC;QACtE,CAAC;QAED,MAAM,uBAAuB,GAC3B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,uBAAuB,EAAE,6BAAa,CAAC,uBAAuB,CAAC,CAAC;QACjF,IAAI,CAAC,2BAA2B,GAAG,IAAI,uDAA0B,CAAC,uBAAuB,CAAC,CAAC;QAE3F,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,eAAe,GAAG,IAAI,GAAG,EAAoC,CAAC;QAEnE,oFAAoF;QACpF,yEAAyE;QACzE,MAAM,kBAAkB,GAAoC,qBAAqB,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;QACpG,kBAAkB,CAAC,IAAI,CACrB,CAAC,CAAgC,EAAE,CAAgC,KAAK,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,WAAW,CAAC,CACnH,CAAC;QAEF,MAAM,kBAAkB,GACpB,iBAAiB,CAAC,6BAA6B,CAAC,kBAAkB,CAAC,CAAC;QAExE,GAAG,CAAC,CAAC,MAAM,WAAW,IAAI,kBAAkB,CAAC,CAAC,CAAC;YAC7C,MAAM,eAAe,GAAuB,kBAAkB,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;YAChF,EAAE,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;gBACpB,MAAM,OAAO,GAA6B,IAAI,kCAAwB,CAAC,WAAW,EAAE,IAAI,EAAE,eAAe,CAAC,CAAC;gBAC3G,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAC7B,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;oBAClD,MAAM,IAAI,KAAK,CAAC,qBAAqB,OAAO,CAAC,WAAW,gCAAgC;0BACpF,uCAAuC,CAAC,CAAC;gBAC/C,CAAC;gBACD,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;YACzD,CAAC;QACH,CAAC;QAED,GAAG,CAAC,CAAC,MAAM,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACrC,OAAO,CAAC,wBAAwB,CAAC,OAAO,CAAC,CAAC,uBAA+B;gBACvE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,gBAAgB,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC;oBACpD,MAAM,IAAI,KAAK,CAAC,sBAAsB,uBAAuB,2BAA2B;0BACpF,2DAA2D,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC;gBACxF,CAAC;YACH,CAAC,CAAC,CAAC;YAEH,wEAAwE;YACxE,IAAI,CAAC,+BAA+B,CAAC,OAAO,CAAC,WAAW,CAAC,YAAY,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC;YAC5F,IAAI,CAAC,+BAA+B,CAAC,OAAO,CAAC,WAAW,CAAC,eAAe,EAAE,OAAO,CAAC,WAAW,CAAC,CAAC;QACjG,CAAC;QAED,sDAAsD;QACtD,MAAM,kBAAkB,GAAW,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,sBAAsB,EAAE,6BAAa,CAAC,sBAAsB,CAAC,CAAC;QAChH,IAAI,CAAC,eAAe,GAAG,yDAA2B,CAAC,eAAe,CAAC,kBAAkB,CAAC,CAAC;IACzF,CAAC;IA5iBD;;;OAGG;IACI,MAAM,CAAC,yBAAyB,CAAC,gBAAwB;QAC9D,MAAM,qBAAqB,GAA2B,4BAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC;QAEtF,2FAA2F;QAC3F,2GAA2G;QAC3G,6BAA6B;QAC7B,MAAM,mBAAmB,GAAW,qBAAqB,CAAC,WAAW,CAAC;QACtE,qFAAqF;QACrF,EAAE,CAAC,CAAC,mBAAmB,IAAI,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAC,CAAC;YAC7D,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,cAAI,CAAC,OAAO,EAAE,mBAAmB,CAAC,CAAC,CAAC,CAAC;gBACjD,MAAM,IAAI,KAAK,CAAC,6BAA6B,cAAI,CAAC,OAAO,kBAAkB;oBACzE,oBAAoB,qBAAqB,CAAC,WAAW,gBAAgB;oBACrE,uCAAuC,CAAC,CAAC;YAC7C,CAAC;YAAC,IAAI,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,EAAE,CAAC,mBAAmB,EAAE,mCAAmC,CAAC,CAAC,CAAC,CAAC;gBAC/E,MAAM,IAAI,KAAK,CAAC,wBAAwB,mBAAmB,oCAAoC;oBAC7F,oCAAoC,mCAAmC,GAAG,CAAC,CAAC;YAChF,CAAC;QACH,CAAC;QAED,iBAAiB,CAAC,WAAW,CAAC,cAAc,CAAC,qBAAqB,EAAE,gBAAgB,CAAC,CAAC;QAEtF,MAAM,CAAC,IAAI,iBAAiB,CAAC,qBAAqB,EAAE,gBAAgB,CAAC,CAAC;IACxE,CAAC;IAEM,MAAM,CAAC,uBAAuB;QACnC,MAAM,gBAAgB,GAAuB,iBAAiB,CAAC,uBAAuB,EAAE,CAAC;QACzF,EAAE,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACrB,MAAM,CAAC,iBAAiB,CAAC,yBAAyB,CAAC,gBAAgB,CAAC,CAAC;QACvE,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;QACjE,CAAC;IACH,CAAC;IAED;;OAEG;IACI,MAAM,CAAC,uBAAuB,CAAC,UAAmB,IAAI;QAC3D,IAAI,aAAa,GAAW,OAAO,CAAC,GAAG,EAAE,CAAC;QAE1C,6EAA6E;QAC7E,GAAG,CAAC,CAAC,IAAI,CAAC,GAAW,CAAC,EAAE,CAAC,GAAG,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC;YACpC,MAAM,gBAAgB,GAAW,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,WAAW,CAAC,CAAC;YAEvE,EAAE,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;gBACrC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,OAAO,CAAC,CAAC,CAAC;oBACrB,OAAO,CAAC,GAAG,CAAC,yBAAyB,GAAG,gBAAgB,CAAC,CAAC;gBAC5D,CAAC;gBAED,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;oBACZ,OAAO,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC;gBAClB,CAAC;gBAED,MAAM,CAAC,gBAAgB,CAAC;YAC1B,CAAC;YAED,MAAM,YAAY,GAAW,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;YACzD,EAAE,CAAC,CAAC,YAAY,KAAK,aAAa,CAAC,CAAC,CAAC;gBACnC,KAAK,CAAC;YACR,CAAC;YAED,aAAa,GAAG,YAAY,CAAC;QAC/B,CAAC;QAED,MAAM,CAAC,SAAS,CAAC;IACnB,CAAC;IAED;;;OAGG;IACI,MAAM,CAAC,gBAAgB;QAC5B,MAAM,oBAAoB,GAAW,OAAO,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC,QAAQ,KAAK,OAAO,CAAC,GAAG,aAAa,GAAG,MAAM,CAAC,CAAC;QAC1G,MAAM,UAAU,GAAW,IAAI,CAAC,OAAO,CAAC,oBAAoB,CAAC,CAAC;QAC9D,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;QAC5E,CAAC;QAED,MAAM,CAAC,UAAU,CAAC;IACpB,CAAC;IAED;;;;OAIG;IACK,MAAM,CAAC,6BAA6B,CAAC,kBAAmD;QAG9F,MAAM,kBAAkB,GACtB,IAAI,GAAG,EAAyC,CAAC;QACnD,MAAM,aAAa,GAAgB,IAAI,GAAG,EAAU,CAAC;QAErD,6EAA6E;QAC7E,GAAG,CAAC,CAAC,MAAM,WAAW,IAAI,kBAAkB,CAAC,CAAC,CAAC;YAC7C,+DAA+D;YAC/D,MAAM,YAAY,GAAW,mBAAS,CAAC,sBAAsB,CAAC,WAAW,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC;YAE5F,qFAAqF;YACrF,6BAA6B;YAC7B,IAAI,OAAO,GAAW,CAAC,CAAC;YACxB,IAAI,eAAe,GAAW,GAAG,6BAAa,CAAC,gBAAgB,IAAI,YAAY,EAAE,CAAC;YAClF,OAAO,aAAa,CAAC,GAAG,CAAC,eAAe,CAAC,EAAE,CAAC;gBAC1C,EAAE,OAAO,CAAC;gBACV,eAAe,GAAG,GAAG,6BAAa,CAAC,gBAAgB,IAAI,YAAY,IAAI,OAAO,EAAE,CAAC;YACnF,CAAC;YACD,aAAa,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;YACnC,kBAAkB,CAAC,GAAG,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;QACvD,CAAC;QAED,MAAM,CAAC,kBAAkB,CAAC;IAC5B,CAAC;IAED;;;;;;OAMG;IACK,MAAM,CAAC,+BAA+B,CAAC,sBAA8B;QAC3E,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,UAAU,CAAC,sBAAsB,CAAC,CAAC,CAAC,CAAC;YAC5C,OAAO,CAAC,GAAG,CAAC,oBAAoB,sBAAsB,EAAE,CAAC,CAAC;YAC1D,GAAG,CAAC,UAAU,CAAC,sBAAsB,CAAC,CAAC;YACvC,MAAM,CAAC;QACT,CAAC;QAED,MAAM,SAAS,GAAa,GAAG,CAAC,WAAW,CAAC,sBAAsB,CAAC,CAAC;QACpE,GAAG,CAAC,CAAC,MAAM,QAAQ,IAAI,SAAS,CAAC,CAAC,CAAC;YACjC,MAAM,gBAAgB,GAAW,IAAI,CAAC,OAAO,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;YAEhF,yCAAyC;YACzC,MAAM,IAAI,GAAc,GAAG,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAC;YACxD,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;gBAC7C,QAAQ,CAAC;YACX,CAAC;YAED,kCAAkC;YAClC,MAAM,aAAa,GAAW,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;YACrD,EAAE,CAAC,CAAC,CAAC,MAAM,EAAE,WAAW,EAAE,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAC9E,QAAQ,CAAC;YACX,CAAC;YAED,MAAM,QAAQ,GAAgB,IAAI,GAAG,CAAS,wBAAwB,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;YAElG,+DAA+D;YAC/D,EAAE,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;gBAC1C,MAAM,IAAI,KAAK,CAAC,yBAAyB,QAAQ,wCAAwC;sBACrF,IAAI,sBAAsB,EAAE,CAAC,CAAC;YACpC,CAAC;QACH,CAAC;IACH,CAAC;IAED;;OAEG;IACH,IAAW,YAAY;QACrB,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;OAEG;IACH,IAAW,aAAa;QACtB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAED;;;;OAIG;IACH,IAAW,YAAY;QACrB,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED;;;;;;;OAOG;IACH,IAAW,sBAAsB;QAC/B,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED;;;;OAIG;IACH,IAAW,gBAAgB;QACzB,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC;IAChC,CAAC;IAED;;;;;;;OAOG;IACH,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;;;;;OAMG;IACH,IAAW,YAAY;QACrB,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC;IAC5B,CAAC;IAED;;;;;OAKG;IACH,IAAW,2BAA2B;QACpC,MAAM,CAAC,IAAI,CAAC,4BAA4B,CAAC;IAC3C,CAAC;IAED;;;;;OAKG;IACH,IAAW,sBAAsB;QAC/B,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED;;;OAGG;IACH,IAAW,UAAU;QACnB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED;;;;;;OAMG;IACH,IAAW,oBAAoB;QAC7B,MAAM,CAAC,IAAI,CAAC,qBAAqB,CAAC;IACpC,CAAC;IAED;;OAEG;IACH,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;;;OAIG;IACH,IAAW,eAAe;QACxB,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC;IAC/B,CAAC;IAED;;;;;OAKG;IACH,IAAW,qBAAqB;QAC9B,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC;IACrC,CAAC;IAED;;;;;OAKG;IACH,IAAW,qBAAqB;QAC9B,MAAM,CAAC,IAAI,CAAC,sBAAsB,CAAC;IACrC,CAAC;IAED;;OAEG;IACH,IAAW,sBAAsB;QAC/B,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED;;;;;;OAMG;IACH,IAAW,sBAAsB;QAC/B,MAAM,CAAC,IAAI,CAAC,uBAAuB,CAAC;IACtC,CAAC;IAED;;;;;OAKG;IACH,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;OAEG;IACH,IAAW,aAAa;QACtB,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC;IAC7B,CAAC;IAED;;;OAGG;IACH,IAAW,gBAAgB;QACzB,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC;IAChC,CAAC;IAED,IAAW,QAAQ;QACjB,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;IACxB,CAAC;IAED,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;;;OAIG;IACH,IAAW,cAAc;QACvB,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC;IAC9B,CAAC;IAED;;;OAGG;IACH,IAAW,UAAU;QACnB,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC1B,CAAC;IAED;;;OAGG;IACI,gBAAgB,CAAC,WAAmB;QACzC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;IAC/C,CAAC;IAED;;;;;OAKG;IACI,0BAA0B,CAAC,oBAA4B;QAC5D,2BAA2B;QAC3B,IAAI,MAAM,GAAyC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,oBAAoB,CAAC,CAAC;QAClG,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;YACX,MAAM,CAAC,MAAM,CAAC;QAChB,CAAC;QAED,iCAAiC;QACjC,GAAG,CAAC,CAAC,MAAM,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACrC,EAAE,CAAC,CAAC,mBAAS,CAAC,sBAAsB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,IAAI,KAAK,oBAAoB,CAAC,CAAC,CAAC;gBACxF,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;oBACX,4CAA4C;oBAC5C,MAAM,CAAC,SAAS,CAAC;gBACnB,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACN,MAAM,GAAG,OAAO,CAAC;gBACnB,CAAC;YACH,CAAC;QACH,CAAC;QACD,MAAM,CAAC,MAAM,CAAC;IAChB,CAAC;IAED;;;OAGG;IACI,qBAAqB,CAAC,eAAuB;QAClD,iCAAiC;QACjC,GAAG,CAAC,CAAC,MAAM,OAAO,IAAI,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACrC,EAAE,CAAC,CAAC,OAAO,CAAC,eAAe,KAAK,eAAe,CAAC,CAAC,CAAC;gBAChD,MAAM,CAAC,OAAO,CAAC;YACjB,CAAC;QACH,CAAC;QACD,MAAM,CAAC,SAAS,CAAC;IACnB,CAAC;IAED;;OAEG;IACH,IAAW,0BAA0B;QACnC,MAAM,CAAC,IAAI,CAAC,2BAA2B,CAAC;IAC1C,CAAC;IAmIO,+BAA+B,CACrC,YAAmD,EACnD,WAAmB;QAEnB,EAAE,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;YAClB,MAAM,CAAC;QACT,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,cAAc;YAC9C,MAAM,UAAU,GAAyC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;YAElG,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;gBACf,UAAU,CAAC,4BAA4B,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;YAC5D,CAAC;QACH,CAAC,CAAC,CAAC;IACL,CAAC;;AArmBc,6BAAW,GAAe,8BAAU,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,EAAE,6BAA6B,CAAC,CAAC,CAAC;AADpH,oCAumBC","file":"data/RushConfiguration.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport * as path from 'path';\r\nimport * as fsx from 'fs-extra';\r\nimport * as semver from 'semver';\r\nimport { JsonFile, JsonSchema } from '@microsoft/node-core-library';\r\n\r\nimport Rush from '../Rush';\r\nimport RushConfigurationProject, { IRushConfigurationProjectJson } from './RushConfigurationProject';\r\nimport { PinnedVersionsConfiguration } from './PinnedVersionsConfiguration';\r\nimport Utilities from '../utilities/Utilities';\r\nimport { RushConstants } from '../RushConstants';\r\nimport { ApprovedPackagesPolicy } from './ApprovedPackagesPolicy';\r\nimport EventHooks from './EventHooks';\r\nimport { VersionPolicyConfiguration } from './VersionPolicyConfiguration';\r\n\r\nconst MINIMUM_SUPPORTED_RUSH_JSON_VERSION: string = '0.0.0';\r\n\r\n/**\r\n * A list of known config filenames that are expected to appear in the \"./common/config/rush\" folder.\r\n * To avoid confusion/mistakes, any extra files will be reported as an error.\r\n */\r\nconst knownRushConfigFilenames: string[] = [\r\n  '.npmrc',\r\n  RushConstants.npmShrinkwrapFilename,\r\n  RushConstants.pinnedVersionsFilename,\r\n  RushConstants.browserApprovedPackagesFilename,\r\n  RushConstants.nonbrowserApprovedPackagesFilename,\r\n  RushConstants.versionPoliciesFileName,\r\n  RushConstants.commandLineFilename\r\n];\r\n\r\n/**\r\n * Part of IRushConfigurationJson.\r\n */\r\nexport interface IApprovedPackagesPolicyJson {\r\n  reviewCategories?: string[];\r\n  ignoredNpmScopes?: string[];\r\n}\r\n\r\n/**\r\n * Part of IRushConfigurationJson.\r\n */\r\nexport interface IRushGitPolicyJson {\r\n  allowedEmailRegExps?: string[];\r\n  sampleEmail?: string;\r\n}\r\n\r\n/**\r\n * Part of IRushConfigurationJson.\r\n * @beta\r\n */\r\nexport interface IEventHooksJson {\r\n  /**\r\n   * The list of scripts to run after every Rush build command finishes\r\n   */\r\n  postRushBuild?: string[];\r\n}\r\n\r\n/**\r\n * Part of IRushConfigurationJson.\r\n */\r\nexport interface IRushRepositoryJson {\r\n  /**\r\n   * The remote url of the repository. It helps 'Rush change' finds the right remote to compare against.\r\n   */\r\n  url: string;\r\n}\r\n\r\n/**\r\n * This represents the JSON data structure for the \"rush.json\" configuration file.\r\n * See rush.schema.json for documentation.\r\n */\r\nexport interface IRushConfigurationJson {\r\n  $schema: string;\r\n  npmVersion: string;\r\n  rushVersion: string;\r\n  repository?: IRushRepositoryJson;\r\n  nodeSupportedVersionRange?: string;\r\n  projectFolderMinDepth?: number;\r\n  projectFolderMaxDepth?: number;\r\n  approvedPackagesPolicy?: IApprovedPackagesPolicyJson;\r\n  gitPolicy?: IRushGitPolicyJson;\r\n  telemetryEnabled?: boolean;\r\n  projects: IRushConfigurationProjectJson[];\r\n  eventHooks?: IEventHooksJson;\r\n}\r\n\r\n/**\r\n * This represents the JSON data structure for the \"rush-link.json\" data file.\r\n * @public\r\n */\r\nexport interface IRushLinkJson {\r\n  localLinks: {\r\n    [name: string]: string[]\r\n  };\r\n}\r\n\r\n/**\r\n * This represents the Rush configuration for a repository, based on the Rush.json\r\n * configuration file.\r\n * @public\r\n */\r\nexport default class RushConfiguration {\r\n  private static _jsonSchema: JsonSchema = JsonSchema.fromFile(path.join(__dirname, '../schemas/rush.schema.json'));\r\n\r\n  private _rushJsonFile: string;\r\n  private _rushJsonFolder: string;\r\n  private _changesFolder: string;\r\n  private _commonFolder: string;\r\n  private _commonTempFolder: string;\r\n  private _commonRushConfigFolder: string;\r\n  private _npmCacheFolder: string;\r\n  private _npmTmpFolder: string;\r\n  private _committedShrinkwrapFilename: string;\r\n  private _tempShrinkwrapFilename: string;\r\n  private _homeFolder: string;\r\n  private _rushLinkJsonFilename: string;\r\n  private _npmToolVersion: string;\r\n  private _npmToolFilename: string;\r\n  private _projectFolderMinDepth: number;\r\n  private _projectFolderMaxDepth: number;\r\n\r\n  // \"approvedPackagesPolicy\" feature\r\n  private _approvedPackagesPolicy: ApprovedPackagesPolicy;\r\n\r\n  // \"gitPolicy\" feature\r\n  private _gitAllowedEmailRegExps: string[];\r\n  private _gitSampleEmail: string;\r\n\r\n  // Repository info\r\n  private _repositoryUrl: string;\r\n\r\n  // Rush hooks\r\n  private _eventHooks: EventHooks;\r\n\r\n  private _pinnedVersions: PinnedVersionsConfiguration;\r\n\r\n  private _telemetryEnabled: boolean;\r\n\r\n  private _projects: RushConfigurationProject[];\r\n  private _projectsByName: Map<string, RushConfigurationProject>;\r\n\r\n  private _versionPolicyConfiguration: VersionPolicyConfiguration;\r\n\r\n  /**\r\n   * Loads the configuration data from an Rush.json configuration file and returns\r\n   * an RushConfiguration object.\r\n   */\r\n  public static loadFromConfigurationFile(rushJsonFilename: string): RushConfiguration {\r\n    const rushConfigurationJson: IRushConfigurationJson = JsonFile.load(rushJsonFilename);\r\n\r\n    // Check the Rush version *before* we validate the schema, since if the version is outdated\r\n    // then the schema may have changed. This should no longer be a problem after Rush 4.0 and the C2R wrapper,\r\n    // but we'll validate anyway.\r\n    const expectedRushVersion: string = rushConfigurationJson.rushVersion;\r\n    // If the version is missing or malformed, fall through and let the schema handle it.\r\n    if (expectedRushVersion && semver.valid(expectedRushVersion)) {\r\n      if (semver.lt(Rush.version, expectedRushVersion)) {\r\n        throw new Error(`Your rush tool is version ${Rush.version}, but rush.json ` +\r\n          `requires version ${rushConfigurationJson.rushVersion}. To upgrade, ` +\r\n          `run \"npm install @microsoft/rush -g\".`);\r\n      } else if (semver.lt(expectedRushVersion, MINIMUM_SUPPORTED_RUSH_JSON_VERSION)) {\r\n        throw new Error(`rush.json is version ${expectedRushVersion}, which is too old for this tool. ` +\r\n          `The minimum supported version is ${MINIMUM_SUPPORTED_RUSH_JSON_VERSION}.`);\r\n      }\r\n    }\r\n\r\n    RushConfiguration._jsonSchema.validateObject(rushConfigurationJson, rushJsonFilename);\r\n\r\n    return new RushConfiguration(rushConfigurationJson, rushJsonFilename);\r\n  }\r\n\r\n  public static loadFromDefaultLocation(): RushConfiguration {\r\n    const rushJsonLocation: string | undefined = RushConfiguration.tryFindRushJsonLocation();\r\n    if (rushJsonLocation) {\r\n      return RushConfiguration.loadFromConfigurationFile(rushJsonLocation);\r\n    } else {\r\n      throw new Error('Unable to find rush.json configuration file');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Find the rush.json location and return the path, or undefined if a rush.json can't be found.\r\n   */\r\n  public static tryFindRushJsonLocation(verbose: boolean = true): string | undefined {\r\n    let currentFolder: string = process.cwd();\r\n\r\n    // Look upwards at parent folders until we find a folder containing rush.json\r\n    for (let i: number = 0; i < 10; ++i) {\r\n      const rushJsonFilename: string = path.join(currentFolder, 'rush.json');\r\n\r\n      if (fsx.existsSync(rushJsonFilename)) {\r\n        if (i > 0 && verbose) {\r\n          console.log('Found configuration in ' + rushJsonFilename);\r\n        }\r\n\r\n        if (verbose) {\r\n          console.log('');\r\n        }\r\n\r\n        return rushJsonFilename;\r\n      }\r\n\r\n      const parentFolder: string = path.dirname(currentFolder);\r\n      if (parentFolder === currentFolder) {\r\n        break;\r\n      }\r\n\r\n      currentFolder = parentFolder;\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * Get the user's home directory. On windows this looks something like \"C:\\users\\username\\\" and on UNIX\r\n   * this looks something like \"/usr/username/\"\r\n   */\r\n  public static getHomeDirectory(): string {\r\n    const unresolvedUserFolder: string = process.env[(process.platform === 'win32') ? 'USERPROFILE' : 'HOME'];\r\n    const homeFolder: string = path.resolve(unresolvedUserFolder);\r\n    if (!fsx.existsSync(homeFolder)) {\r\n      throw new Error('Unable to determine the current user\\'s home directory');\r\n    }\r\n\r\n    return homeFolder;\r\n  }\r\n\r\n  /**\r\n   * This generates the unique names that are used to create temporary projects\r\n   * in the Rush common folder.\r\n   * NOTE: sortedProjectJsons is sorted by the caller.\r\n   */\r\n  private static _generateTempNamesForProjects(sortedProjectJsons: IRushConfigurationProjectJson[]):\r\n    Map<IRushConfigurationProjectJson, string> {\r\n\r\n    const tempNamesByProject: Map<IRushConfigurationProjectJson, string> =\r\n      new Map<IRushConfigurationProjectJson, string>();\r\n    const usedTempNames: Set<string> = new Set<string>();\r\n\r\n    // NOTE: projectJsons was already sorted in alphabetical order by the caller.\r\n    for (const projectJson of sortedProjectJsons) {\r\n      // If the name is \"@ms/MyProject\", extract the \"MyProject\" part\r\n      const unscopedName: string = Utilities.parseScopedPackageName(projectJson.packageName).name;\r\n\r\n      // Generate a unique like name \"@rush-temp/MyProject\", or \"@rush-temp/MyProject-2\" if\r\n      // there is a naming conflict\r\n      let counter: number = 0;\r\n      let tempProjectName: string = `${RushConstants.rushTempNpmScope}/${unscopedName}`;\r\n      while (usedTempNames.has(tempProjectName)) {\r\n        ++counter;\r\n        tempProjectName = `${RushConstants.rushTempNpmScope}/${unscopedName}-${counter}`;\r\n      }\r\n      usedTempNames.add(tempProjectName);\r\n      tempNamesByProject.set(projectJson, tempProjectName);\r\n    }\r\n\r\n    return tempNamesByProject;\r\n  }\r\n\r\n  /**\r\n   * If someone adds a config file in the \"common/rush/config\" folder, it would be a bad\r\n   * experience for Rush to silently ignore their file simply because they misspelled the\r\n   * filename, or maybe it's an old format that's no longer supported.  The\r\n   * _validateCommonRushConfigFolder() function makes sure that this folder only contains\r\n   * recognized config files.\r\n   */\r\n  private static _validateCommonRushConfigFolder(commonRushConfigFolder: string): void {\r\n    if (!fsx.existsSync(commonRushConfigFolder)) {\r\n      console.log(`Creating folder: ${commonRushConfigFolder}`);\r\n      fsx.mkdirsSync(commonRushConfigFolder);\r\n      return;\r\n    }\r\n\r\n    const filenames: string[] = fsx.readdirSync(commonRushConfigFolder);\r\n    for (const filename of filenames) {\r\n      const resolvedFilename: string = path.resolve(commonRushConfigFolder, filename);\r\n\r\n      // Ignore things that aren't actual files\r\n      const stat: fsx.Stats = fsx.lstatSync(resolvedFilename);\r\n      if (!stat.isFile() && !stat.isSymbolicLink()) {\r\n        continue;\r\n      }\r\n\r\n      // Ignore harmless file extensions\r\n      const fileExtension: string = path.extname(filename);\r\n      if (['.bak', '.disabled', '.md', '.old', '.orig'].indexOf(fileExtension) >= 0) {\r\n        continue;\r\n      }\r\n\r\n      const knownSet: Set<string> = new Set<string>(knownRushConfigFilenames.map(x => x.toUpperCase()));\r\n\r\n      // Is the filename something we know?  If not, report an error.\r\n      if (!knownSet.has(filename.toUpperCase())) {\r\n        throw new Error(`An unrecognized file \"${filename}\" was found in the Rush config folder:`\r\n          + ` ${commonRushConfigFolder}`);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * The Rush configuration file\r\n   */\r\n  public get rushJsonFile(): string {\r\n    return this._rushJsonFile;\r\n  }\r\n\r\n  /**\r\n   * The folder that contains rush.json for this project.\r\n   */\r\n  public get rushJsonFolder(): string {\r\n    return this._rushJsonFolder;\r\n  }\r\n\r\n  /**\r\n   * The folder that contains all change files.\r\n   */\r\n  public get changesFolder(): string {\r\n    return this._changesFolder;\r\n  }\r\n\r\n  /**\r\n   * The fully resolved path for the \"common\" folder where Rush will store settings that\r\n   * affect all Rush projects.  This is always a subfolder of the folder containing \"rush.json\".\r\n   * Example: \"C:\\MyRepo\\common\"\r\n   */\r\n  public get commonFolder(): string {\r\n    return this._commonFolder;\r\n  }\r\n\r\n  /**\r\n   * The folder where Rush's additional config files are stored.  This folder is always a\r\n   * subfolder called \"config\\rush\" inside the common folder.  (The \"common\\config\" folder\r\n   * is reserved for configuration files used by other tools.)  To avoid confusion or mistakes,\r\n   * Rush will report an error if this this folder contains any unrecognized files.\r\n   *\r\n   * Example: \"C:\\MyRepo\\common\\config\\rush\"\r\n   */\r\n  public get commonRushConfigFolder(): string {\r\n    return this._commonRushConfigFolder;\r\n  }\r\n\r\n  /**\r\n   * The folder where temporary files will be stored.  This is always a subfolder called \"temp\"\r\n   * inside the common folder.\r\n   * Example: \"C:\\MyRepo\\common\\temp\"\r\n   */\r\n  public get commonTempFolder(): string {\r\n    return this._commonTempFolder;\r\n  }\r\n\r\n  /**\r\n   * The local folder that will store the NPM package cache.  Rush does not rely on the\r\n   * NPM's default global cache folder, because NPM's caching implementation does not\r\n   * reliably handle multiple processes.  (For example, if a build box is running\r\n   * \"rush install\" simultaneously for two different working folders, it may fail randomly.)\r\n   *\r\n   * Example: \"C:\\MyRepo\\common\\temp\\npm-cache\"\r\n   */\r\n  public get npmCacheFolder(): string {\r\n    return this._npmCacheFolder;\r\n  }\r\n\r\n  /**\r\n   * The local folder where NPM's temporary files will be written during installation.\r\n   * Rush does not rely on the global default folder, because it may be on a different\r\n   * hard disk.\r\n   *\r\n   * Example: \"C:\\MyRepo\\common\\temp\\npm-tmp\"\r\n   */\r\n  public get npmTmpFolder(): string {\r\n    return this._npmTmpFolder;\r\n  }\r\n\r\n  /**\r\n   * The filename of the NPM shrinkwrap file that is tracked e.g. by Git.  (The \"rush install\"\r\n   * command uses a temporary copy, whose path is tempShrinkwrapFilename.)\r\n   * This property merely reports the filename; the file itself may not actually exist.\r\n   * Example: \"C:\\MyRepo\\common\\npm-shrinkwrap.json\"\r\n   */\r\n  public get committedShrinkwrapFilename(): string {\r\n    return this._committedShrinkwrapFilename;\r\n  }\r\n\r\n  /**\r\n   * The filename of the temporary NPM shrinkwrap file that is used by \"rush install\".\r\n   * (The master copy is tempShrinkwrapFilename.)\r\n   * This property merely reports the filename; the file itself may not actually exist.\r\n   * Example: \"C:\\MyRepo\\common\\temp\\npm-shrinkwrap.json\"\r\n   */\r\n  public get tempShrinkwrapFilename(): string {\r\n    return this._tempShrinkwrapFilename;\r\n  }\r\n\r\n  /**\r\n   * The absolute path to the home directory for the current user.  On Windows,\r\n   * it would be something like \"C:\\Users\\YourName\".\r\n   */\r\n  public get homeFolder(): string {\r\n    return this._homeFolder;\r\n  }\r\n\r\n  /**\r\n   * The filename of the build dependency data file.  By default this is\r\n   * called 'rush-link.json' resides in the Rush common folder.\r\n   * Its data structure is defined by IRushLinkJson.\r\n   *\r\n   * Example: \"C:\\MyRepo\\common\\temp\\rush-link.json\"\r\n   */\r\n  public get rushLinkJsonFilename(): string {\r\n    return this._rushLinkJsonFilename;\r\n  }\r\n\r\n  /**\r\n   * The version of the locally installed NPM tool.  (Example: \"1.2.3\")\r\n   */\r\n  public get npmToolVersion(): string {\r\n    return this._npmToolVersion;\r\n  }\r\n\r\n  /**\r\n   * The absolute path to the locally installed NPM tool.  If \"rush install\" has not\r\n   * been run, then this file may not exist yet.\r\n   * Example: \"C:\\MyRepo\\common\\temp\\npm-local\\node_modules\\.bin\\npm\"\r\n   */\r\n  public get npmToolFilename(): string {\r\n    return this._npmToolFilename;\r\n  }\r\n\r\n  /**\r\n   * The minimum allowable folder depth for the projectFolder field in the rush.json file.\r\n   * This setting provides a way for repository maintainers to discourage nesting of project folders\r\n   * that makes the directory tree more difficult to navigate.  The default value is 2,\r\n   * which implements a standard 2-level hierarchy of <categoryFolder>/<projectFolder>/package.json.\r\n   */\r\n  public get projectFolderMinDepth(): number {\r\n    return this._projectFolderMinDepth;\r\n  }\r\n\r\n  /**\r\n   * The maximum allowable folder depth for the projectFolder field in the rush.json file.\r\n   * This setting provides a way for repository maintainers to discourage nesting of project folders\r\n   * that makes the directory tree more difficult to navigate.  The default value is 2,\r\n   * which implements on a standard convention of <categoryFolder>/<projectFolder>/package.json.\r\n   */\r\n  public get projectFolderMaxDepth(): number {\r\n    return this._projectFolderMaxDepth;\r\n  }\r\n\r\n  /**\r\n   * The \"approvedPackagesPolicy\" settings.\r\n   */\r\n  public get approvedPackagesPolicy(): ApprovedPackagesPolicy {\r\n    return this._approvedPackagesPolicy;\r\n  }\r\n\r\n  /**\r\n   * [Part of the \"gitPolicy\" feature.]\r\n   * A list of regular expressions describing allowable e-mail patterns for Git commits.\r\n   * They are case-insensitive anchored JavaScript RegExps.\r\n   * Example: \".*@example\\.com\"\r\n   * This array will never be undefined.\r\n   */\r\n  public get gitAllowedEmailRegExps(): string[] {\r\n    return this._gitAllowedEmailRegExps;\r\n  }\r\n\r\n  /**\r\n   * [Part of the \"gitPolicy\" feature.]\r\n   * An example valid e-mail address that conforms to one of the allowedEmailRegExps.\r\n   * Example: \"foxtrot@example\\.com\"\r\n   * This will never be undefined, and will always be nonempty if gitAllowedEmailRegExps is used.\r\n   */\r\n  public get gitSampleEmail(): string {\r\n    return this._gitSampleEmail;\r\n  }\r\n\r\n  /**\r\n   * The remote url of the repository. It helps 'Rush change' finds the right remote to compare against.\r\n   */\r\n  public get repositoryUrl(): string {\r\n    return this._repositoryUrl;\r\n  }\r\n\r\n  /**\r\n   * Indicates whether telemetry collection is enabled for Rush runs.\r\n   * @beta\r\n   */\r\n  public get telemetryEnabled(): boolean {\r\n    return this._telemetryEnabled;\r\n  }\r\n\r\n  public get projects(): RushConfigurationProject[] {\r\n    return this._projects;\r\n  }\r\n\r\n  public get projectsByName(): Map<string, RushConfigurationProject> {\r\n    return this._projectsByName;\r\n  }\r\n\r\n  /**\r\n   * The PinnedVersionsConfiguration object.  If the pinnedVersions.json file is missing,\r\n   * this property will NOT be undefined.  Instead it will be initialized in an empty state,\r\n   * and calling PinnedVersionsConfiguration.save() will create the file.\r\n   */\r\n  public get pinnedVersions(): PinnedVersionsConfiguration {\r\n    return this._pinnedVersions;\r\n  }\r\n\r\n  /**\r\n   * The rush hooks. It allows customized scripts to run at the specified point.\r\n   * @beta\r\n   */\r\n  public get eventHooks(): EventHooks {\r\n    return this._eventHooks;\r\n  }\r\n\r\n  /**\r\n   * Looks up a project in the projectsByName map.  If the project is not found,\r\n   * then undefined is returned.\r\n   */\r\n  public getProjectByName(projectName: string): RushConfigurationProject | undefined {\r\n    return this._projectsByName.get(projectName);\r\n  }\r\n\r\n  /**\r\n   * This is used e.g. by command-line interfaces such as \"rush build --to example\".\r\n   * If \"example\" is not a project name, then it also looks for a scoped name\r\n   * like \"@something/example\".  If exactly one project matches this heuristic, it\r\n   * is returned.  Otherwise, undefined is returned.\r\n   */\r\n  public findProjectByShorthandName(shorthandProjectName: string): RushConfigurationProject | undefined {\r\n    // Is there an exact match?\r\n    let result: RushConfigurationProject | undefined = this._projectsByName.get(shorthandProjectName);\r\n    if (result) {\r\n      return result;\r\n    }\r\n\r\n    // Is there an approximate match?\r\n    for (const project of this._projects) {\r\n      if (Utilities.parseScopedPackageName(project.packageName).name === shorthandProjectName) {\r\n        if (result) {\r\n          // Ambiguous -- there is more than one match\r\n          return undefined;\r\n        } else {\r\n          result = project;\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Looks up a project by its RushConfigurationProject.tempProjectName field.\r\n   * @returns The found project, or undefined if no match was found.\r\n   */\r\n  public findProjectByTempName(tempProjectName: string): RushConfigurationProject | undefined {\r\n    // Is there an approximate match?\r\n    for (const project of this._projects) {\r\n      if (project.tempProjectName === tempProjectName) {\r\n        return project;\r\n      }\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * @beta\r\n   */\r\n  public get versionPolicyConfiguration(): VersionPolicyConfiguration {\r\n    return this._versionPolicyConfiguration;\r\n  }\r\n\r\n  /**\r\n   * Use RushConfiguration.loadFromConfigurationFile() or Use RushConfiguration.loadFromDefaultLocation()\r\n   * instead.\r\n   */\r\n  private constructor(rushConfigurationJson: IRushConfigurationJson, rushJsonFilename: string) {\r\n    if (rushConfigurationJson.nodeSupportedVersionRange) {\r\n      if (!semver.validRange(rushConfigurationJson.nodeSupportedVersionRange)) {\r\n        throw new Error('Error parsing the node-semver expression in the \"nodeSupportedVersionRange\"'\r\n          + ` field from rush.json: \"${rushConfigurationJson.nodeSupportedVersionRange}\"`);\r\n      }\r\n      if (!semver.satisfies(process.version, rushConfigurationJson.nodeSupportedVersionRange)) {\r\n        throw new Error(`Your dev environment is running Node.js version ${process.version} which does`\r\n          + ` not meet the requirements for building this repository.  (The rush.json configuration`\r\n          + ` requires nodeSupportedVersionRange=\"${rushConfigurationJson.nodeSupportedVersionRange}\")`);\r\n      }\r\n    }\r\n    this._rushJsonFile = rushJsonFilename;\r\n    this._rushJsonFolder = path.dirname(rushJsonFilename);\r\n\r\n    this._commonFolder = path.resolve(path.join(this._rushJsonFolder, RushConstants.commonFolderName));\r\n\r\n    this._commonRushConfigFolder = path.join(this._commonFolder, 'config', 'rush');\r\n    RushConfiguration._validateCommonRushConfigFolder(this._commonRushConfigFolder);\r\n\r\n    this._commonTempFolder = path.join(this._commonFolder, RushConstants.rushTempFolderName);\r\n    this._npmCacheFolder = path.resolve(path.join(this._commonTempFolder, 'npm-cache'));\r\n    this._npmTmpFolder = path.resolve(path.join(this._commonTempFolder, 'npm-tmp'));\r\n\r\n    this._changesFolder = path.join(this._commonFolder, RushConstants.changeFilesFolderName);\r\n\r\n    this._committedShrinkwrapFilename = path.join(this._commonRushConfigFolder, RushConstants.npmShrinkwrapFilename);\r\n    this._tempShrinkwrapFilename = path.join(this._commonTempFolder, RushConstants.npmShrinkwrapFilename);\r\n\r\n    this._homeFolder = RushConfiguration.getHomeDirectory();\r\n\r\n    this._rushLinkJsonFilename = path.join(this._commonTempFolder, 'rush-link.json');\r\n\r\n    this._npmToolVersion = rushConfigurationJson.npmVersion;\r\n    this._npmToolFilename = path.resolve(path.join(this._commonTempFolder,\r\n      'npm-local', 'node_modules', '.bin', 'npm'));\r\n\r\n    this._projectFolderMinDepth = rushConfigurationJson.projectFolderMinDepth !== undefined\r\n      ? rushConfigurationJson.projectFolderMinDepth : 1;\r\n    if (this._projectFolderMinDepth < 1) {\r\n      throw new Error('Invalid projectFolderMinDepth; the minimum possible value is 1');\r\n    }\r\n\r\n    this._projectFolderMaxDepth = rushConfigurationJson.projectFolderMaxDepth !== undefined\r\n      ? rushConfigurationJson.projectFolderMaxDepth : 2;\r\n    if (this._projectFolderMaxDepth < this._projectFolderMinDepth) {\r\n      throw new Error('The projectFolderMaxDepth cannot be smaller than the projectFolderMinDepth');\r\n    }\r\n\r\n    this._approvedPackagesPolicy = new ApprovedPackagesPolicy(this, rushConfigurationJson);\r\n\r\n    this._gitAllowedEmailRegExps = [];\r\n    this._gitSampleEmail = '';\r\n    if (rushConfigurationJson.gitPolicy) {\r\n      if (rushConfigurationJson.gitPolicy.sampleEmail) {\r\n        this._gitSampleEmail = rushConfigurationJson.gitPolicy.sampleEmail;\r\n      }\r\n\r\n      if (rushConfigurationJson.gitPolicy.allowedEmailRegExps) {\r\n        this._gitAllowedEmailRegExps = rushConfigurationJson.gitPolicy.allowedEmailRegExps;\r\n\r\n        if (this._gitSampleEmail.trim().length < 1) {\r\n          throw new Error('The rush.json file is missing the \"sampleEmail\" option, ' +\r\n            'which is required when using \"allowedEmailRegExps\"');\r\n        }\r\n      }\r\n    }\r\n\r\n    if (rushConfigurationJson.repository) {\r\n      this._repositoryUrl = rushConfigurationJson.repository.url;\r\n    }\r\n\r\n    this._telemetryEnabled = !!rushConfigurationJson.telemetryEnabled;\r\n    if (rushConfigurationJson.eventHooks) {\r\n      this._eventHooks = new EventHooks(rushConfigurationJson.eventHooks);\r\n    }\r\n\r\n    const versionPolicyConfigFile: string =\r\n      path.join(this._commonRushConfigFolder, RushConstants.versionPoliciesFileName);\r\n    this._versionPolicyConfiguration = new VersionPolicyConfiguration(versionPolicyConfigFile);\r\n\r\n    this._projects = [];\r\n    this._projectsByName = new Map<string, RushConfigurationProject>();\r\n\r\n    // We sort the projects array in alphabetical order.  This ensures that the packages\r\n    // are processed in a deterministic order by the various Rush algorithms.\r\n    const sortedProjectJsons: IRushConfigurationProjectJson[] = rushConfigurationJson.projects.slice(0);\r\n    sortedProjectJsons.sort(\r\n      (a: IRushConfigurationProjectJson, b: IRushConfigurationProjectJson) => a.packageName.localeCompare(b.packageName)\r\n    );\r\n\r\n    const tempNamesByProject: Map<IRushConfigurationProjectJson, string>\r\n      = RushConfiguration._generateTempNamesForProjects(sortedProjectJsons);\r\n\r\n    for (const projectJson of sortedProjectJsons) {\r\n      const tempProjectName: string | undefined = tempNamesByProject.get(projectJson);\r\n      if (tempProjectName) {\r\n        const project: RushConfigurationProject = new RushConfigurationProject(projectJson, this, tempProjectName);\r\n        this._projects.push(project);\r\n        if (this._projectsByName.get(project.packageName)) {\r\n          throw new Error(`The project name \"${project.packageName}\" was specified more than once`\r\n            + ` in the rush.json configuration file.`);\r\n        }\r\n        this._projectsByName.set(project.packageName, project);\r\n      }\r\n    }\r\n\r\n    for (const project of this._projects) {\r\n      project.cyclicDependencyProjects.forEach((cyclicDependencyProject: string) => {\r\n        if (!this.getProjectByName(cyclicDependencyProject)) {\r\n          throw new Error(`In rush.json, the \"${cyclicDependencyProject}\" project does not exist,`\r\n            + ` but was referenced by the cyclicDependencyProjects for ${project.packageName}`);\r\n        }\r\n      });\r\n\r\n      // Compute the downstream dependencies within the list of Rush projects.\r\n      this._populateDownstreamDependencies(project.packageJson.dependencies, project.packageName);\r\n      this._populateDownstreamDependencies(project.packageJson.devDependencies, project.packageName);\r\n    }\r\n\r\n    // Example: \"./common/config/rush/pinnedVersions.json\"\r\n    const pinnedVersionsFile: string = path.join(this.commonRushConfigFolder, RushConstants.pinnedVersionsFilename);\r\n    this._pinnedVersions = PinnedVersionsConfiguration.tryLoadFromFile(pinnedVersionsFile);\r\n  }\r\n\r\n  private _populateDownstreamDependencies(\r\n    dependencies: { [key: string]: string } | undefined,\r\n    packageName: string): void {\r\n\r\n    if (!dependencies) {\r\n      return;\r\n    }\r\n    Object.keys(dependencies).forEach(dependencyName => {\r\n      const depProject: RushConfigurationProject | undefined = this._projectsByName.get(dependencyName);\r\n\r\n      if (depProject) {\r\n        depProject.downstreamDependencyProjects.push(packageName);\r\n      }\r\n    });\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\src"}