{"version":3,"sources":["cli/actions/BaseRushAction.ts"],"names":[],"mappings":";;AAAA,4FAA4F;AAC5F,2DAA2D;AAC3D,yBAAyB;AACzB,6BAA6B;AAE7B,gEAGoC;AAEpC,oEAA6D;AAC7D,sEAA+D;AAE/D;;GAEG;AACH,oBAAqC,SAAQ,mCAAiB;IAI5D,YAAY,OAAkC;QAC5C,KAAK,CAAC,OAAO,CAAC,CAAC;IACjB,CAAC;IAES,SAAS;QACjB,IAAI,CAAC,kBAAkB,EAAE,CAAC;QAC1B,OAAO,CAAC,GAAG,CAAC,kBAAkB,IAAI,CAAC,OAAO,CAAC,UAAU,IAAI,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;QACnE,IAAI,CAAC,GAAG,EAAE,CAAC;IACb,CAAC;IAQD,IAAc,iBAAiB;QAC7B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,kBAAkB,GAAG,2BAAiB,CAAC,uBAAuB,EAAE,CAAC;QACxE,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC;IACjC,CAAC;IAED,IAAc,iBAAiB;QAC7B,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,kBAAkB,GAAG,IAAI,2BAAiB,CAAC,IAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;QACrF,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC;IACjC,CAAC;IAEO,kBAAkB;QACxB,gDAAgD;QAChD,IAAI,eAAe,GAAW,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;QAClD,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,gBAAgB,EAAE,cAAc,EAAE,MAAM,CAAC;YAC1F,IAAI,CAAC,SAAS,GAAG,eAAe,CAAC;QACnC,gDAAgD;QAChD,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,GAAG,eAAe,CAAC;IACxC,CAAC;CACF;AA1CD,wCA0CC","file":"cli/actions/BaseRushAction.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\nimport * as os from 'os';\r\nimport * as path from 'path';\r\n\r\nimport {\r\n  CommandLineAction,\r\n  ICommandLineActionOptions\r\n} from '@microsoft/ts-command-line';\r\n\r\nimport RushConfiguration from '../../data/RushConfiguration';\r\nimport EventHooksManager from '../utilities/EventHooksManager';\r\n\r\n/**\r\n * The base Rush action that all Rush actions should extend.\r\n */\r\nexport abstract class BaseRushAction extends CommandLineAction {\r\n  private _rushConfiguration: RushConfiguration;\r\n  private _eventHooksManager: EventHooksManager;\r\n\r\n  constructor(options: ICommandLineActionOptions) {\r\n    super(options);\r\n  }\r\n\r\n  protected onExecute(): void {\r\n    this._ensureEnvironment();\r\n    console.log(`Starting \"rush ${this.options.actionVerb}\"${os.EOL}`);\r\n    this.run();\r\n  }\r\n\r\n  /**\r\n   * All Rush actions need to implement this method. This method runs after\r\n   * environment has been set up by the base class.\r\n   */\r\n  protected abstract run(): void;\r\n\r\n  protected get rushConfiguration(): RushConfiguration {\r\n    if (!this._rushConfiguration) {\r\n      this._rushConfiguration = RushConfiguration.loadFromDefaultLocation();\r\n    }\r\n    return this._rushConfiguration;\r\n  }\r\n\r\n  protected get eventHooksManager(): EventHooksManager {\r\n    if (!this._eventHooksManager) {\r\n      this._eventHooksManager = new EventHooksManager(this.rushConfiguration.eventHooks);\r\n    }\r\n    return this._eventHooksManager;\r\n  }\r\n\r\n  private _ensureEnvironment(): void {\r\n    /* tslint:disable-next-line:no-string-literal */\r\n    let environmentPath: string = process.env['PATH'];\r\n    environmentPath = path.join(this.rushConfiguration.commonTempFolder, 'node_modules', '.bin') +\r\n      path.delimiter + environmentPath;\r\n    /* tslint:disable-next-line:no-string-literal */\r\n    process.env['PATH'] = environmentPath;\r\n  }\r\n}"],"sourceRoot":"..\\..\\..\\src"}