{"version":3,"sources":["cli/utilities/test/ChangeManager.test.ts"],"names":[],"mappings":"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","file":"cli/utilities/test/ChangeManager.test.js","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n// See LICENSE in the project root for license information.\r\n\r\nimport { expect } from 'chai';\r\nimport * as path from 'path';\r\n\r\nimport RushConfiguration from '../../../data/RushConfiguration';\r\nimport ChangeManager from '../ChangeManager';\r\nimport PrereleaseToken from '../PrereleaseToken';\r\n\r\ndescribe('ChangeManager', () => {\r\n  const rushJsonFile: string = path.resolve(__dirname, 'packages', 'rush.json');\r\n  let rushConfiguration: RushConfiguration;\r\n  let changeManager: ChangeManager;\r\n\r\n  beforeEach(() => {\r\n    rushConfiguration = RushConfiguration.loadFromConfigurationFile(rushJsonFile);\r\n    changeManager = new ChangeManager(rushConfiguration);\r\n  });\r\n\r\n  /* tslint:disable:no-string-literal */\r\n  it('can apply changes to the package.json files in the dictionary', () => {\r\n    changeManager.load(path.join(__dirname, 'multipleChanges'));\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('a')!.packageJson.version).equals('2.0.0', 'a was not 2.0.0');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.version).equals('1.0.1', 'b was not patched');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.dependencies!['a']).equals(\r\n      '>=2.0.0 <3.0.0',\r\n      'the \"a\" dependency in \"b\" was not updated');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.0', 'c version was changed');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.dependencies!['b']).equals(\r\n      '>=1.0.1 <2.0.0',\r\n      'the \"b\" dependency in \"c\" was not updated');\r\n  });\r\n\r\n  it('can update explicit version dependency', () => {\r\n    changeManager.load(path.join(__dirname, 'explicitVersionChange'));\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.1', 'c was not patched');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.version).equals('1.0.1', 'd was not patched');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.dependencies!['c']).equals(\r\n      '1.0.1',\r\n      'the \"c\" dependency in \"d\" was not updated');\r\n  });\r\n\r\n  it('can update explicit cyclic dependency', () => {\r\n    changeManager.load(path.join(__dirname, 'cyclicDepsExplicit'));\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('cyclic-dep-explicit-1')!.packageJson.version).equals(\r\n      '2.0.0',\r\n      'cyclic-dep-explicit-1 should have been updated.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-explicit-1')!.packageJson.dependencies!['cyclic-dep-explicit-2'])\r\n      .equals(\r\n        '>=1.0.1 <2.0.0',\r\n        'the \"cyclic-dep-explicit-2\" dependency in \"cyclic-dep-explicit-1\" should be updated');\r\n    expect(changeManager.allPackages.get('cyclic-dep-explicit-2')!.packageJson.version).equals(\r\n      '1.0.1',\r\n      'cyclic-dep-explicit-2 should have patch version update.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-explicit-2')!.packageJson.dependencies!['cyclic-dep-explicit-1'])\r\n      .equals(\r\n        '>=1.0.0 <2.0.0',\r\n        'the \"cyclic-dep-explicit-1\" dependency in \"cyclic-dep-explicit-2\" should not be updated');\r\n  });\r\n\r\n  it('can update root with patch change for prerelease', () => {\r\n    const prereleaseName: string = 'alpha.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(prereleaseName);\r\n\r\n    changeManager.load(path.join(__dirname, 'rootPatchChange'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('a')!.packageJson.version).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'a should have the prereleased version');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.version).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'b should have the prereleased version');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.dependencies!['a']).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'the \"a\" dependency in \"b\" should be updated');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.1-' + prereleaseName,\r\n      'c should have the prereleased version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.version).equals('1.0.1-' + prereleaseName,\r\n      'd should have the prereleased version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.dependencies!['c']).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'the \"c\" dependency in \"d\" should be updated');\r\n  });\r\n\r\n  it('can update non-root with patch change for prerelease', () => {\r\n    const prereleaseName: string = 'beta.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(prereleaseName);\r\n\r\n    changeManager.load(path.join(__dirname, 'explicitVersionChange'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('a')!.packageJson.version).equals(\r\n      '1.0.0',\r\n      'a version should not be changed.');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.version).equals(\r\n      '1.0.0',\r\n      'b version should not be changed.');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.dependencies!['a']).equals(\r\n      '>=1.0.0 <2.0.0',\r\n      'the \"a\" dependency in \"b\" should not be changed.');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.1-' + prereleaseName,\r\n      'c should have the prereleased version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.version).equals('1.0.1-' + prereleaseName,\r\n      'd should have the prereleased version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.dependencies!['c']).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'the \"c\" dependency in \"d\" should be updated');\r\n  });\r\n\r\n  it('can update cyclic dependency for non-explicit prerelease', () => {\r\n    const prereleaseName: string = 'beta.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(prereleaseName);\r\n\r\n    changeManager.load(path.join(__dirname, 'cyclicDeps'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('cyclic-dep-1')!.packageJson.version).equals(\r\n      '2.0.0-' + prereleaseName,\r\n      'cyclic-dep-1 should have prerelease version.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-1')!.packageJson.dependencies!['cyclic-dep-2']).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'the \"cyclic-dep-2\" dependency in \"cyclic-dep-1\" should be updated');\r\n    expect(changeManager.allPackages.get('cyclic-dep-2')!.packageJson.version).equals(\r\n      '1.0.1-' + prereleaseName,\r\n      'cyclic-dep-2 should have prerelease version.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-2')!.packageJson.dependencies!['cyclic-dep-1']).equals(\r\n      '2.0.0-' + prereleaseName,\r\n      'the \"cyclic-dep-1\" dependency in \"cyclic-dep-2\" should be updated');\r\n  });\r\n\r\n  it('can update root with patch change for adding version suffix', () => {\r\n    const suffix: string = 'dk.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(undefined, suffix);\r\n\r\n    changeManager.load(path.join(__dirname, 'rootPatchChange'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('a')!.packageJson.version).equals(\r\n      '1.0.0-' + suffix,\r\n      'a should have the suffix version');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.version).equals(\r\n      '1.0.0-' + suffix,\r\n      'b should have the suffix version');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.dependencies!['a']).equals(\r\n      '1.0.0-' + suffix,\r\n      'the \"a\" dependency in \"b\" should be updated');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.0-' + suffix,\r\n      'c should have the suffix version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.version).equals('1.0.0-' + suffix,\r\n      'd should have the suffix version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.dependencies!['c']).equals(\r\n      '1.0.0-' + suffix,\r\n      'the \"c\" dependency in \"d\" should be updated');\r\n  });\r\n\r\n  it('can update non-root with patch change for version suffix', () => {\r\n    const suffix: string = 'dk.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(undefined, suffix);\r\n\r\n    changeManager.load(path.join(__dirname, 'explicitVersionChange'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('a')!.packageJson.version).equals(\r\n      '1.0.0',\r\n      'a version should not be changed.');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.version).equals(\r\n      '1.0.0',\r\n      'b version should not be changed.');\r\n    expect(changeManager.allPackages.get('b')!.packageJson.dependencies!['a']).equals(\r\n      '>=1.0.0 <2.0.0',\r\n      'the \"a\" dependency in \"b\" should not be changed.');\r\n    expect(changeManager.allPackages.get('c')!.packageJson.version).equals('1.0.0-' + suffix,\r\n      'c should have the suffix version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.version).equals('1.0.0-' + suffix,\r\n      'd should have the suffix version');\r\n    expect(changeManager.allPackages.get('d')!.packageJson.dependencies!['c']).equals(\r\n      '1.0.0-' + suffix,\r\n      'the \"c\" dependency in \"d\" should be updated');\r\n  });\r\n\r\n  it('can update cyclic dependency for non-explicit suffix', () => {\r\n    const suffix: string = 'dk.1';\r\n    const prereleaseToken: PrereleaseToken = new PrereleaseToken(undefined, suffix);\r\n\r\n    changeManager.load(path.join(__dirname, 'cyclicDeps'), prereleaseToken);\r\n    changeManager.apply(false);\r\n\r\n    expect(changeManager.allPackages.get('cyclic-dep-1')!.packageJson.version).equals(\r\n      '1.0.0-' + suffix,\r\n      'cyclic-dep-1 should have suffix version.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-1')!.packageJson.dependencies!['cyclic-dep-2']).equals(\r\n      '1.0.0-' + suffix,\r\n      'the \"cyclic-dep-2\" dependency in \"cyclic-dep-1\" should be updated');\r\n    expect(changeManager.allPackages.get('cyclic-dep-2')!.packageJson.version).equals(\r\n      '1.0.0-' + suffix,\r\n      'cyclic-dep-2 should have prerelease version.');\r\n    expect(changeManager.allPackages.get('cyclic-dep-2')!.packageJson.dependencies!['cyclic-dep-1']).equals(\r\n      '1.0.0-' + suffix,\r\n      'the \"cyclic-dep-1\" dependency in \"cyclic-dep-2\" should be updated');\r\n  });\r\n  /* tslint:enable:no-string-literal */\r\n});\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}