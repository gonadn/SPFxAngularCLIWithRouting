var ApplicationCustomizerPages = (function () {
    function ApplicationCustomizerPages(serverURL) {
        this._serverURL = serverURL;
    }
    ApplicationCustomizerPages.prototype.TestName = function () {
        return 'ApplicationCustomizer Pages Test';
    };
    ApplicationCustomizerPages.prototype.TestOwner = function () {
        return 'dagaeta';
    };
    ApplicationCustomizerPages.prototype.TestIncludeScripts = function () {
        return [
            '<ProductScriptsLocation>msajaxbundle.debug.js',
            '<ProductScriptsLocation>sp.runtime.debug.js',
            '<ProductScriptsLocation>sp.debug.js',
            '<TestLocation>/TabTaskLib.debug.js',
            '<AzureTaskLibLocation>/sp-tab-tasklib.js'
        ];
    };
    ApplicationCustomizerPages.prototype.TestSetup = function () {
        TAB.Log.Comment('ApplicationCustomizer Pages start');
    };
    ApplicationCustomizerPages.prototype.TestRun = function () {
        var _this = this;
        var newsPagePath = '/_layouts/15/news.aspx';
        var customActionParams = '{"e6ebfc48-d18a-46c2-ad11-8133c5badf5e":' +
            '{"location":"ClientSideExtension.ApplicationCustomizer",' +
            '"properties":{"headerMessage":"Header area of the page","footerMessage":"Footer area in the page"}}}';
        var azurePath = TAB.Settings.Get('AzurePath');
        var moduleLoader = azurePath + "/sp-pages-assembly_en-us.js";
        var spQueryParams = {
            loadSPFX: true,
            customActions: customActionParams,
            debugManifestsFile: SPTaskLib.PageUtil.GetDebugManifestsUrl(),
            moduleloader: moduleLoader
        };
        var pageUrl = SPTaskLib.PageUtil.CreatePageUrl(newsPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskClearSecurityDialog(SPTaskLib.PageUtil.SPPageReady());
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowFooterPlaceholderMessage');
        customActionParams = '{"e6ebfc48-d18a-46c2-ad11-8133c5badf5e":' +
            '{"location":"ClientSideExtension.ApplicationCustomizer",' +
            '"sequence": 1,' +
            '"properties":{"headerMessage":"Yellow Header area of the page",' +
            '"footerMessage":"Yellow Footer area in the page"}},' +
            '"a11f15c3-51a3-4f9f-bc7a-e50da31a86b3":' +
            '{"location":"ClientSideExtension.ApplicationCustomizer",' +
            '"sequence": 2,' +
            '"properties":{"headerMessage":"Green Header area of the page",' +
            '"footerMessage":"Green Footer area in the page"}}}';
        spQueryParams.customActions = customActionParams;
        pageUrl = SPTaskLib.PageUtil.CreatePageUrl(newsPagePath, spQueryParams);
        TAB.AddTask(TAB.LoadPage(pageUrl));
        SPTaskLib.PageUtil.AddTaskClearSecurityDialog(SPTaskLib.PageUtil.SPPageReady());
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('YellowFooterPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('GreenHeaderPlaceholderMessage');
        SPTaskLib.PageUtil.AddTaskValidateAutomationIdExists('GreenFooterPlaceholderMessage');
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Validating order of Top Application Customizers');
            _this._topPlaceHolder = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-sp-placeholder='Top']");
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(_this._topPlaceHolder.children[0], TAB.searchBy.customQuery, "[data-automation-id='YellowHeaderPlaceholderMessage']")
                && TAB.ElementExists(_this._topPlaceHolder.children[1], TAB.searchBy.customQuery, "[data-automation-id='GreenHeaderPlaceholderMessage']");
        }));
        TAB.AddTask(TAB.MakeTask(function () {
            TAB.Log.AddTaskComment('Validating order of Bottom Application Customizers');
            _this._bottomPlaceHolder = TAB.GetElement(TAB.Win, TAB.searchBy.customQuery, "[data-sp-placeholder='Bottom']");
        }), TAB.MakeWaiter(function () {
            return TAB.ElementExists(_this._bottomPlaceHolder.children[0], TAB.searchBy.customQuery, "[data-automation-id='GreenFooterPlaceholderMessage']")
                && TAB.ElementExists(_this._bottomPlaceHolder.children[1], TAB.searchBy.customQuery, "[data-automation-id='YellowFooterPlaceholderMessage']");
        }));
        TAB.Log.AddTaskPass('Test complete');
    };
    return ApplicationCustomizerPages;
}());
TabTest = ApplicationCustomizerPages;
